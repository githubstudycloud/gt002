# AI API Gateway Configuration Example
# Copy this file to gateway.yaml and modify as needed

server:
  host: 0.0.0.0
  port: 8080
  read_timeout: 60s
  write_timeout: 60s
  tls:
    enabled: false
    cert_file: ""
    key_file: ""

database:
  type: postgres  # postgres, sqlite, mysql
  host: localhost
  port: 5432
  database: ai_gateway
  username: postgres
  password: changeme
  ssl_mode: disable
  max_open_conns: 25
  max_idle_conns: 5
  conn_max_lifetime: 5m

redis:
  enabled: false
  host: localhost
  port: 6379
  password: ""
  db: 0
  pool_size: 10

auth:
  default_method: api_key
  jwt_secret: "changeme-use-a-strong-secret"
  token_expiry: 24h
  bcrypt_cost: 10

providers:
  openai:
    enabled: true
    base_url: https://api.openai.com/v1
    timeout: 60s
    retry_attempts: 3
    retry_delay: 1s

  claude:
    enabled: true
    base_url: https://api.anthropic.com/v1
    timeout: 60s
    retry_attempts: 3
    retry_delay: 1s

  gemini:
    enabled: true
    base_url: https://generativelanguage.googleapis.com/v1
    timeout: 60s
    retry_attempts: 3
    retry_delay: 1s

  azure_openai:
    enabled: false
    base_url: ""  # https://{resource-name}.openai.azure.com/
    api_version: "2024-02-15-preview"
    timeout: 60s
    retry_attempts: 3
    retry_delay: 1s

  baidu_wenxin:
    enabled: false
    base_url: https://aip.baidubce.com
    timeout: 60s
    retry_attempts: 3
    retry_delay: 1s

logging:
  level: info  # debug, info, warn, error
  format: json  # json, text
  output: stdout  # stdout, file
  file_path: logs/gateway.log
  max_size: 100  # MB
  max_backups: 3
  max_age: 28  # days
  compress: true

monitoring:
  prometheus:
    enabled: true
    port: 9090
    path: /metrics

  metrics:
    collect_token_usage: true
    collect_latency: true
    collect_error_rate: true
    collect_provider_health: true

rate_limit:
  enabled: true
  default_rpm: 60  # requests per minute
  default_rph: 1000  # requests per hour
  default_tpm: 90000  # tokens per minute
  default_tph: 1000000  # tokens per hour
  storage: memory  # memory, redis

cache:
  enabled: false
  ttl: 3600s
  max_size: 1000
  storage: memory  # memory, redis

security:
  cors:
    enabled: true
    allowed_origins:
      - "*"
    allowed_methods:
      - GET
      - POST
      - PUT
      - DELETE
    allowed_headers:
      - "*"
    max_age: 86400

  ip_whitelist:
    enabled: false
    ips: []

  ip_blacklist:
    enabled: false
    ips: []

features:
  smart_routing: true
  request_caching: false
  webhook: false
  mcp_protocol: false
